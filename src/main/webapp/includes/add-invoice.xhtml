<?xml version="1.0" encoding="UTF-8"?>

<div id="add-invoice" class="modal modal-main fade"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://xmlns.jcp.org/jsf/html"
     xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
     xmlns:f="http://xmlns.jcp.org/jsf/core"
     xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
     xmlns:jsf="http://xmlns.jcp.org/jsf">


    <div>
        <a class="modal-close" data-dismiss="modal">
            <i class="fa fa-times"></i>
        </a>
        <div>
            <h:form id="add-invoice-form" prependId="false">
                <div class="modal-content">
                    <div class="form-top">
                        <label>Wystawia</label>
                        <h:selectOneMenu id="invoice-employee"
                                         value="#{invoiceListBean.invoiceEmployeeId}">
                            <f:selectItems
                                    value="#{invoiceListBean.employeesList}"
                                    var="e"
                                    itemLabel="#{e.firstName} #{e.lastName}"
                                    itemValue="#{e.id}"/>
                            <f:ajax event="change"
                                    render="invoice-number-id"
                                    execute="@this"/>
                        </h:selectOneMenu>
                    </div>
                    <div jsf:id="invoice-number-id">
                        <div class="form-top"
                             jsf:rendered="#{invoiceListBean.invoiceNumber ne null}">
                            <h:outputLabel
                                    value="#{invoiceListBean.invoiceNumber.number} - #{invoiceListBean.invoiceNumber.year}">
                            </h:outputLabel>
                        </div>
                    </div>
                    <div class="form-top">
                        <label>Komu</label>
                        <h:selectOneMenu id="invoice-client"
                                         value="#{invoiceListBean.invoiceClientId}">
                            <f:selectItems
                                    value="#{invoiceListBean.clientList}"
                                    var="c"
                                    itemLabel="#{c.name}"
                                    itemValue="#{c.id}"/>
                            <f:ajax event="change"
                                    execute="@this"/>
                        </h:selectOneMenu>
                    </div>
                    <div class="form-top">
                        <h:selectOneMenu id="invoice-amount-type"
                                         value="#{invoiceListBean.amountType}">
                            <f:selectItems value="#{invoiceListBean.amountTypes}"
                                           var="it"
                                           itemLabel="#{it}"
                                           itemValue="#{it}"/>
                            <f:ajax execute="@this"
                                    render="invoice-amount-brutto-type-id invoice-amount-netto-type-id"
                                    onevent="showLoader"/>
                        </h:selectOneMenu>
                    </div>
                    <div jsf:id="invoice-amount-netto-type-id">
                        <div class="form-top" jsf:rendered="#{invoiceListBean.amountType eq 'Netto'}">
                            <label>Kwota netto</label>
                            <h:inputText value="#{invoiceListBean.invoiceDto.netValue}">
                                <f:converter converterId="javax.faces.BigDecimal"/>
                                <f:ajax event="change"
                                        delay="300"
                                        listener="#{invoiceListBean.calculateGrossValue}"
                                        render="invoice-gross-id"
                                        execute="@this"/>
                            </h:inputText>
                        </div>
                    </div>
                    <div jsf:id="invoice-amount-brutto-type-id">
                        <div class="form-top" jsf:rendered="#{invoiceListBean.amountType eq 'Brutto'}">
                            <label>Kwota brutto</label>
                            <h:inputText value="#{invoiceListBean.invoiceDto.grossValue}">
                                <f:converter converterId="javax.faces.BigDecimal"/>
                                <f:ajax event="change"
                                        delay="300"
                                        listener="#{invoiceListBean.calculateNetValue}"
                                        render="invoice-net-id"
                                        execute="@this"/>
                            </h:inputText>
                        </div>
                    </div>
                    <div class="form-top" jsf:id="invoice-net-id">
                        <h:outputLabel rendered="#{invoiceListBean.invoiceDto.grossValue ne null}"
                                       value="Kwota netto: #{invoiceListBean.invoiceDto.netValue}"/>

                    </div>
                    <div class="form-top" jsf:id="invoice-gross-id">
                        <h:outputLabel rendered="#{invoiceListBean.invoiceDto.netValue ne null}"
                                       value="Kwota brutto: #{invoiceListBean.invoiceDto.grossValue}"/>

                    </div>
                </div>
            </h:form>
        </div>
    </div>
</div>